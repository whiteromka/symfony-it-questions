{{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': true}}) }}

{# Поле title #}
<div class="mb-3">
    {{ form_label(form.title, 'Заголовок вопроса', {'label_attr': {'class': 'form-label'}}) }}
    {{ form_widget(form.title, {'attr': {
        'class': 'form-control',
        'required': true
    }}) }}
    <div class="invalid-feedback">
        Пожалуйста, заполните заголовок вопроса.
    </div>
    {{ form_errors(form.title) }}
</div>

{# Поле text с Summernote #}
<div class="mb-3">
    {{ form_label(form.text, 'Текст вопроса', {'label_attr': {'class': 'form-label'}}) }}
    {{ form_widget(form.text, {'attr': {
        'class': 'form-control summernote-basic',
        'rows': 10
    }}) }}
    <div class="form-text">Используйте панель инструментов для форматирования текста</div>
    {{ form_errors(form.text) }}
</div>

{# Группа полей в одну строку #}
<div class="row mb-3">
    <div class="col-md-3">
        {{ form_label(form.difficulty, 'Сложность', {'label_attr': {'class': 'form-label'}}) }}
        {{ form_widget(form.difficulty, {'attr': {'class': 'form-control'}}) }}
        {{ form_errors(form.difficulty) }}
    </div>

    <div class="col-md-3">
        {{ form_label(form.categoryId, 'Категория', {'label_attr': {'class': 'form-label'}}) }}
        {{ form_widget(form.categoryId, {'attr': {'class': 'form-select'}}) }}
        {{ form_errors(form.categoryId) }}
    </div>

    <div class="col-md-3">
        {{ form_label(form.authorId, 'Автор', {'label_attr': {'class': 'form-label'}}) }}
        {{ form_widget(form.authorId, {'attr': {'class': 'form-select'}}) }}
        {{ form_errors(form.authorId) }}
    </div>

    <div class="col-md-3">
        {{ form_label(form.status, 'Статус', {'label_attr': {'class': 'form-label'}}) }}
        {{ form_widget(form.status, {'attr': {'class': 'form-select'}}) }}
        {{ form_errors(form.status) }}
    </div>

</div>

{# Кнопки действий #}
<div class="d-flex justify-content-between mt-4">
    <div>
        <button type="submit" class="btn btn-success me-2">
            <i class="fas fa-save me-1"></i> {{ button_label|default('Сохранить') }}
        </button>
        <a href="{{ path('question_index') }}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-1"></i> Назад к списку
        </a>
    </div>

    {% if form.delete is defined %}
        {{ form_row(form.delete, {
            'label': '<i class="fas fa-trash me-1"></i> Удалить',
            'attr': {'class': 'btn btn-danger'},
            'row_attr': {'class': 'mb-0'}
        }) }}
    {% endif %}
</div>

{{ form_end(form) }}

{# Базовая инициализация Summernote #}
<script>
    function initializeSummernote() {
        // Базовая инициализация для всех элементов с классом summernote-basic
        if ($('.summernote-basic').length) {
            $('.summernote-basic').summernote({
                height: 200,
                lang: 'ru-RU',
                toolbar: [
                    ['style', ['bold', 'italic', 'underline', 'clear']],
                    ['font', ['strikethrough']],
                    ['para', ['ul', 'ol', 'paragraph']],
                    ['insert', ['link']],
                    ['view', ['fullscreen', 'codeview']]
                ]
            });
        }

        // Обработка отправки форм с Summernote
        $('form').on('submit', function() {
            let editor = $('.summernote-basic');
            editor.val(editor.summernote('code'));
        });
    }

    // Ждем полной загрузки страницы
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeSummernote, 50);
        });
    } else {
        setTimeout(initializeSummernote, 50);
    }
</script>